{{ define "main" }}
<div class="container">

  <!-- Title (avoid markdownify on titles to prevent odd spacing/HTML) -->
  <h1 class="mt-5">{{ .Title }}</h1>

  {{ with .Params.Subtitle }}
    <h2 class="font-weight-light font-italic mb-3">{{ . | markdownify }}</h2>
  {{ end }}

  <!-- Meta line: date, updated, reading time, tags -->
  <p class="text-muted mt-3">
    <a class="text-muted" href="{{ .Permalink }}">
      Published {{ .Date.Format "January 2, 2006" }}
    </a>

    {{ if ne .Lastmod .Date }}
      <span class="text-muted"> · Updated {{ .Lastmod.Format "Jan 2, 2006" }}</span>
    {{ end }}

    {{ with .ReadingTime }}
      <span class="text-muted"> · {{ . }} min read</span>
    {{ end }}

    {{ with .Params.tags }}
      <span class="text-muted"> · </span>
      {{ range $i, $t := . }}
        {{ if $i }}, {{ end }}
        <a class="text-muted" href="{{ "/tags/" | relURL }}{{ $t | urlize }}">#{{ $t }}</a>
      {{ end }}
    {{ end }}
  </p>

  <!-- Content -->
  <article class="article mt-5">
    {{ .Content }}
  </article>
</div>

<!-- Prev/Next navigation (safe for nil) -->
{{ if or .Prev .Next }}
  <div class="Nextread bg-light py-5 mt-5">
    <div class="container">
      <h4 class="text-center">Read next</h4>
      <div class="row">

        <div class="col-md-6 text-center">
          {{ with .Prev }}
            <span class="d-block mb-1 text-muted">Previous Post</span>
            <a class="d-inline-block" href="{{ .RelPermalink }}" aria-label="Previous: {{ .Title }}">
              {{ .Title }}
            </a>
          {{ end }}
        </div>

        <div class="col-md-6 text-center">
          {{ with .Next }}
            <span class="d-block mb-1 text-muted">Next Post</span>
            <a class="d-inline-block" href="{{ .RelPermalink }}" aria-label="Next: {{ .Title }}">
              {{ .Title }}
            </a>
          {{ end }}
        </div>

      </div>
    </div>
  </div>
{{ end }}

<hr>

<!-- Related posts (optional; requires related config, but safe as-is) -->
{{ $related := .Site.RegularPages.Related . | first 3 }}
{{ with $related }}
  <div class="container mt-5">
    <h2 class="text-center">See also</h2>
    <div class="row">
      {{ range . }}
        <div class="col-md mb-3">
          <p class="lead mb-0">
            <a class="text-body" href="{{ .RelPermalink }}">{{ .Title }}</a>
          </p>
          {{ with .Params.Subtitle }}
            <p class="lead font-italic mb-0">{{ . | markdownify }}</p>
          {{ end }}
          {{ with .Summary }}
            <p class="font-weight-light mt-3">{{ . }}</p>
          {{ end }}
          <a href="{{ .RelPermalink }}" class="btn btn-primary">Read more</a>
        </div>
      {{ end }}
    </div>
  </div>
{{ end }}

{{ end }}
